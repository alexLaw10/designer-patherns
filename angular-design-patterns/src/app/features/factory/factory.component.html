<div class="factory-demo demo-container">
  <div class="demo-header">
    <h2>üè≠ Factory Pattern</h2>
    <p>O Factory Pattern permite criar objetos sem especificar suas classes concretas.</p>
  </div>
  
  <div class="demo-content">
    <div class="creator-section demo-section">
      <h3>üî® Criar Ve√≠culo</h3>
      <div class="form-grid auto-fit">
    <div class="form-group">
          <label>Tipo:</label>
          <select [(ngModel)]="vehicleType" class="form-select">
        <option *ngFor="let type of availableTypes" [value]="type">
              {{ getVehicleTypeIcon(type) }} {{ type | titlecase }}
        </option>
      </select>
    </div>
    
    <div class="form-group">
      <label>Marca:</label>
          <input type="text" [(ngModel)]="brand" placeholder="Ex: Toyota" class="form-input">
    </div>
    
    <div class="form-group">
      <label>Modelo:</label>
          <input type="text" [(ngModel)]="model" placeholder="Ex: Corolla" class="form-input">
    </div>
    
    <div class="form-group">
      <label>Ano:</label>
          <input type="number" [(ngModel)]="year" [min]="1900" [max]="currentYear" class="form-input">
        </div>
      </div>
      
      <button (click)="createVehicle()" class="btn btn-primary" [disabled]="!isFormValid()">
        üî® Criar Ve√≠culo
      </button>
    </div>
    
    <div class="vehicles-section demo-section">
      <h3>üöó Ve√≠culos Criados ({{ createdVehicles.length }})</h3>
      <div class="vehicles-list item-list">
      <div *ngFor="let vehicle of createdVehicles; let i = index" 
             class="vehicle-item list-item"
           [class.selected]="selectedVehicle === vehicle"
           (click)="selectVehicle(vehicle)">
          
          <div class="vehicle-header">
            <span class="vehicle-icon">{{ getVehicleTypeIcon(vehicle.constructor.name.toLowerCase()) }}</span>
            <span class="vehicle-type">{{ vehicle.constructor.name }}</span>
          </div>
          
        <div class="vehicle-info">
            <div class="vehicle-name">{{ vehicle.getInfo() }}</div>
            <div class="vehicle-specs">
              <span>Tipo: {{ vehicle.constructor.name }}</span>
            </div>
          </div>
          
          <div class="vehicle-actions">
            <button (click)="removeVehicle(i); $event.stopPropagation()" class="btn btn-danger">
              üóëÔ∏è
            </button>
          </div>
        </div>
        
        <div *ngIf="createdVehicles.length === 0" class="empty-state">
        Nenhum ve√≠culo criado ainda
      </div>
    </div>
  </div>

    <div class="controls-section demo-section" *ngIf="selectedVehicle">
      <h3>üéÆ Controles</h3>
      <div class="control-panel">
        <div class="selected-info">
          <span class="selected-icon">{{ getVehicleTypeIcon(selectedVehicle.constructor.name.toLowerCase()) }}</span>
          <span class="selected-name">{{ selectedVehicle.getInfo() }}</span>
        </div>
        <div class="control-buttons">
          <button (click)="startVehicle()" class="btn btn-success">‚ñ∂Ô∏è Ligar</button>
          <button (click)="stopVehicle()" class="btn btn-warning">‚èπÔ∏è Desligar</button>
        </div>
      </div>
    </div>
    
    <div class="log-section demo-section">
      <h3>üìã Log de A√ß√µes</h3>
      <div class="log-controls">
        <button (click)="clearLog()" class="btn btn-secondary">üóëÔ∏è Limpar</button>
      </div>
      <div class="log-list">
        <div *ngFor="let log of actionLog" class="log-item">
          <span class="log-time">{{ getCurrentTime() }}</span>
          <span class="log-message">{{ log }}</span>
        </div>
        <div *ngIf="actionLog.length === 0" class="empty-state">
          Nenhuma a√ß√£o registrada
        </div>
      </div>
    </div>
  </div>

  <div class="explanation">
    <h3>üîç Factory Pattern - Conceito e Implementa√ß√£o</h3>
    <div class="explanation-content">
      
      <div class="concept content-card">
        <h4>üìö Conceito</h4>
        <p>O Factory Pattern √© um padr√£o criacional que fornece uma interface para criar objetos sem especificar suas classes concretas. A factory decide qual classe instanciar baseado em par√¢metros fornecidos.</p>
        <p><strong>Problema que resolve:</strong> Como criar objetos sem acoplar o c√≥digo √†s classes concretas? Como centralizar a l√≥gica de cria√ß√£o de objetos?</p>
      </div>
      
      <div class="flow content-card">
        <h4>üîÑ Fluxo de Funcionamento</h4>
        <div class="flow-steps">
          <div class="flow-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <strong>Cliente solicita cria√ß√£o</strong>
              <p>O cliente chama o m√©todo factory passando par√¢metros que indicam o tipo de objeto desejado.</p>
            </div>
          </div>
          <div class="flow-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <strong>Factory analisa par√¢metros</strong>
              <p>A factory examina os par√¢metros fornecidos para determinar qual tipo de produto criar.</p>
            </div>
          </div>
          <div class="flow-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <strong>Factory instancia produto</strong>
              <p>Baseado na an√°lise, a factory instancia a classe concreta apropriada.</p>
            </div>
          </div>
          <div class="flow-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <strong>Retorna produto configurado</strong>
              <p>A factory retorna o objeto criado, pronto para uso pelo cliente.</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="angular-specific content-card">
        <h4>üÖ∞Ô∏è Como Funciona no Angular</h4>
        <p>No Angular, o Factory Pattern √© usado em v√°rias situa√ß√µes:</p>
        <ul>
          <li><strong>ComponentFactoryResolver:</strong> Para criar componentes dinamicamente</li>
          <li><strong>ViewContainerRef.createComponent():</strong> Cria√ß√£o de componentes em runtime</li>
          <li><strong>Service Factories:</strong> Cria√ß√£o de servi√ßos com configura√ß√µes espec√≠ficas</li>
          <li><strong>Form Controls:</strong> Cria√ß√£o de diferentes tipos de controles de formul√°rio</li>
        </ul>
      </div>
      
      <div class="code-example content-card">
        <h4>üíª C√≥digo do Exemplo</h4>
        <div class="code-block">
          <div class="code-header">
            <div class="traffic-lights">
              <div class="traffic-light close"></div>
              <div class="traffic-light minimize"></div>
              <div class="traffic-light maximize"></div>
            </div>
            <div class="code-title">vehicle-factory.service.ts</div>
          </div>
          <pre><code>// Interface do produto
export interface Vehicle &#123;
  getInfo(): string;
  start(): void;
  stop(): void;
&#125;

// Produtos concretos
export class Car implements Vehicle &#123;
  constructor(private brand: string, private model: string, private year: number) &#123;&#125;
  
  getInfo(): string &#123;
    return this.brand + ' ' + this.model + ' (' + this.year + ')';
  &#125;
  
  start(): void &#123;
    console.log('Carro ligado');
  &#125;
  
  stop(): void &#123;
    console.log('Carro desligado');
  &#125;
&#125;

// Factory Service
@Injectable(&#123;
  providedIn: 'root'
&#125;)
export class VehicleFactoryService &#123;
  createVehicle(type: string, brand: string, model: string, year: number): Vehicle &#123;
    switch (type.toLowerCase()) &#123;
      case 'car':
        return new Car(brand, model, year);
      case 'motorcycle':
        return new Motorcycle(brand, model, year);
      case 'truck':
        return new Truck(brand, model, year);
      default:
        throw new Error('Tipo de ve√≠culo n√£o suportado: ' + type);
    &#125;
  &#125;
&#125;</code></pre>
        </div>
      </div>
      
    </div>
  </div>
</div>