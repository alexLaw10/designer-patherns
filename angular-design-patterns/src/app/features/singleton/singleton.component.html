<div class="singleton-demo">
  <div class="demo-header">
    <h2>üîí Singleton Pattern</h2>
    <p>O Singleton Pattern garante que uma classe tenha apenas uma inst√¢ncia e fornece um ponto global de acesso a ela.</p>
  </div>
  
  <div class="demo-content">
    <div class="instance-info">
      <h3>üè∑Ô∏è Informa√ß√µes da Inst√¢ncia</h3>
      <div class="info-card">
        <div class="info-item">
          <span class="info-label">ID da Inst√¢ncia:</span>
          <span class="info-value">{{ instanceId }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Total de Logs:</span>
          <span class="info-value">{{ totalLogs }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Status:</span>
          <span class="info-value status-active">Ativo</span>
        </div>
      </div>
    </div>
    
    <div class="log-creator">
      <h3>üìù Criar Log</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>N√≠vel do Log:</label>
          <select [(ngModel)]="selectedLevel" class="form-select">
            <option *ngFor="let level of getLogLevels()" [value]="level">
              {{ getLogLevelIcon(level) }} {{ getLogLevelName(level) }}
            </option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Fonte (opcional):</label>
          <input type="text" [(ngModel)]="newSource" placeholder="Ex: AuthService" class="form-input">
        </div>
        
        <div class="form-group full-width">
          <label>Mensagem:</label>
          <input type="text" [(ngModel)]="newMessage" placeholder="Digite sua mensagem..." class="form-input" (keyup.enter)="addLog()">
        </div>
      </div>
      
      <div class="form-actions">
        <button (click)="addLog()" class="btn-primary" [disabled]="!newMessage.trim()">
          ‚ûï Adicionar Log
        </button>
        <button (click)="addSampleLogs()" class="btn-secondary">
          üéØ Logs de Exemplo
        </button>
        <button (click)="addRandomLog()" class="btn-info">
          üé≤ Log Aleat√≥rio
        </button>
      </div>
    </div>
    
    <div class="logs-section">
      <h3>üìã Logs Registrados</h3>
      <div class="logs-controls">
        <button (click)="clearLogs()" class="btn-danger">
          üóëÔ∏è Limpar Logs
        </button>
        <button (click)="exportLogs()" class="btn-success">
          üíæ Exportar JSON
        </button>
      </div>
      
      <div class="logs-stats">
        <div class="stat-item" *ngFor="let level of getLogLevels()">
          <span class="stat-icon">{{ getLogLevelIcon(level) }}</span>
          <span class="stat-label">{{ getLogLevelName(level) }}:</span>
          <span class="stat-value">{{ logsByLevel[level] }}</span>
        </div>
      </div>
      
      <div class="logs-list">
        <div *ngFor="let log of logs; let i = index" 
             class="log-item" 
             [style.border-left-color]="getLogLevelColor(log.level)">
          <div class="log-header">
            <span class="log-icon">{{ getLogLevelIcon(log.level) }}</span>
            <span class="log-level">{{ log.level }}</span>
            <span class="log-time">{{ log.timestamp | date:'HH:mm:ss.SSS' }}</span>
            <span class="log-source" *ngIf="log.source">[{{ log.source }}]</span>
          </div>
          <div class="log-message">{{ log.message }}</div>
          <div class="log-data" *ngIf="log.data">
            <pre>{{ log.data | json }}</pre>
          </div>
        </div>
        
        <div *ngIf="logs.length === 0" class="empty-logs">
          <span class="empty-icon">üìù</span>
          <p>Nenhum log registrado ainda</p>
          <small>Crie um log usando o formul√°rio acima</small>
        </div>
      </div>
    </div>
  </div>
  
  <div class="explanation">
    <h3>üîç Contexto Completo do Singleton Pattern</h3>
    <div class="explanation-content">
      <div class="concept">
        <h4>üìö Conceito e Origem</h4>
        <p>O Singleton Pattern √© um padr√£o criacional fundamental da Gang of Four (GoF) que garante que uma classe tenha apenas uma inst√¢ncia e fornece um ponto global de acesso a essa inst√¢ncia. No Angular, os servi√ßos com <code>providedIn: 'root'</code> s√£o singletons por padr√£o.</p>
        <p><strong>Hist√≥rico:</strong> Tamb√©m criado em 1994 pelos mesmos autores dos outros padr√µes GoF. √â um dos padr√µes mais controversos, sendo muito √∫til quando usado corretamente, mas considerado um "anti-pattern" quando mal aplicado.</p>
        <p><strong>Problema que resolve:</strong> Como garantir que uma classe tenha apenas uma inst√¢ncia? Como controlar o acesso global a recursos compartilhados? Como evitar a cria√ß√£o desnecess√°ria de objetos caros?</p>
      </div>
      
      <div class="real-world-examples">
        <h4>üåç Exemplos do Mundo Real</h4>
        <div class="examples-grid">
          <div class="example-card">
            <h5>üîß Sistemas de Configura√ß√£o</h5>
            <ul>
              <li><strong>Configura√ß√µes de App:</strong> Settings, environment variables</li>
              <li><strong>Database Config:</strong> Connection strings, credentials</li>
              <li><strong>Feature Flags:</strong> A/B testing, feature toggles</li>
              <li><strong>API Keys:</strong> Third-party service credentials</li>
            </ul>
          </div>
          <div class="example-card">
            <h5>üìä Sistemas de Logging</h5>
            <ul>
              <li><strong>Application Logs:</strong> Centralized logging</li>
              <li><strong>Error Tracking:</strong> Sentry, Bugsnag</li>
              <li><strong>Analytics:</strong> Google Analytics, Mixpanel</li>
              <li><strong>Audit Trails:</strong> Security logs, compliance</li>
            </ul>
          </div>
          <div class="example-card">
            <h5>üóÑÔ∏è Gerenciamento de Recursos</h5>
            <ul>
              <li><strong>Database Connections:</strong> Connection pooling</li>
              <li><strong>Cache Systems:</strong> Redis, Memcached</li>
              <li><strong>Thread Pools:</strong> Executor services</li>
              <li><strong>File Systems:</strong> File watchers, monitors</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="components">
        <h4>üß© Componentes</h4>
        <div class="component-list">
          <div class="component">
            <strong>Singleton Class:</strong>
            <ul>
              <li>Construtor privado para evitar instancia√ß√£o externa</li>
              <li>M√©todo est√°tico para obter a inst√¢ncia √∫nica</li>
              <li>Vari√°vel est√°tica para armazenar a inst√¢ncia</li>
            </ul>
          </div>
          <div class="component">
            <strong>Angular DI (Dependency Injection):</strong>
            <ul>
              <li>Servi√ßos com <code>providedIn: 'root'</code> s√£o singletons</li>
              <li>Angular gerencia o ciclo de vida automaticamente</li>
              <li>Inje√ß√£o de depend√™ncia em toda a aplica√ß√£o</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="flow">
        <h4>üîÑ Fluxo de Funcionamento</h4>
        <div class="flow-steps">
          <div class="flow-step">
            <span class="step-number">1</span>
            <div class="step-content">
              <strong>Cria√ß√£o:</strong> Angular cria a inst√¢ncia √∫nica do servi√ßo
            </div>
          </div>
          <div class="flow-step">
            <span class="step-number">2</span>
            <div class="step-content">
              <strong>Registro:</strong> Servi√ßo √© registrado no sistema de DI
            </div>
          </div>
          <div class="flow-step">
            <span class="step-number">3</span>
            <div class="step-content">
              <strong>Inje√ß√£o:</strong> Mesma inst√¢ncia √© injetada em todos os componentes
            </div>
          </div>
          <div class="flow-step">
            <span class="step-number">4</span>
            <div class="step-content">
              <strong>Reutiliza√ß√£o:</strong> Estado √© compartilhado entre todos os consumidores
            </div>
          </div>
        </div>
      </div>
      
      <div class="benefits">
        <h4>‚úÖ Vantagens</h4>
        <ul>
          <li><strong>Inst√¢ncia √∫nica:</strong> Garante apenas uma inst√¢ncia em toda a aplica√ß√£o</li>
          <li><strong>Acesso global:</strong> Ponto centralizado de acesso</li>
          <li><strong>Economia de recursos:</strong> Evita cria√ß√£o desnecess√°ria de objetos</li>
          <li><strong>Estado compartilhado:</strong> Dados compartilhados entre componentes</li>
          <li><strong>Controle de acesso:</strong> Controle sobre quando a inst√¢ncia √© criada</li>
        </ul>
      </div>
      
      <div class="use-cases">
        <h4>üéØ Casos de Uso Detalhados</h4>
        <div class="use-cases-grid">
          <div class="use-case">
            <h5>üìä Logging e Monitoramento</h5>
            <p>Sistema centralizado para logs, m√©tricas e monitoramento da aplica√ß√£o.</p>
            <ul>
              <li>Application logs</li>
              <li>Error tracking</li>
              <li>Performance metrics</li>
              <li>User analytics</li>
            </ul>
          </div>
          <div class="use-case">
            <h5>‚öôÔ∏è Configura√ß√£o Global</h5>
            <p>Gerenciamento centralizado de configura√ß√µes e settings da aplica√ß√£o.</p>
            <ul>
              <li>Environment variables</li>
              <li>Feature flags</li>
              <li>API endpoints</li>
              <li>Security settings</li>
            </ul>
          </div>
          <div class="use-case">
            <h5>üíæ Cache e Estado</h5>
            <p>Gerenciamento de cache e estado compartilhado entre componentes.</p>
            <ul>
              <li>In-memory cache</li>
              <li>Session storage</li>
              <li>Global state</li>
              <li>Data persistence</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="angular-specific">
        <h4>‚ö° Singleton Pattern no Angular</h4>
        <div class="angular-examples">
          <div class="angular-example">
            <h5>üèóÔ∏è Dependency Injection</h5>
            <p>O Angular implementa Singleton atrav√©s do sistema de DI:</p>
            <ul>
              <li><strong>providedIn: 'root':</strong> Singleton em toda a aplica√ß√£o</li>
              <li><strong>providedIn: 'platform':</strong> Singleton entre aplica√ß√µes</li>
              <li><strong>providedIn: 'any':</strong> Singleton por m√≥dulo</li>
              <li><strong>Custom Providers:</strong> useFactory, useClass</li>
            </ul>
          </div>
          <div class="angular-example">
            <h5>üéØ Service Lifecycle</h5>
            <p>Gerenciamento autom√°tico do ciclo de vida dos servi√ßos:</p>
            <ul>
              <li>Cria√ß√£o lazy (on-demand)</li>
              <li>Destrui√ß√£o autom√°tica</li>
              <li>Memory management</li>
              <li>Tree shaking</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="anti-patterns">
        <h4>‚ö†Ô∏è Quando N√ÉO Usar Singleton</h4>
        <div class="anti-patterns-grid">
          <div class="anti-pattern">
            <h5>‚ùå Problemas Comuns</h5>
            <ul>
              <li><strong>Global State:</strong> Pode causar acoplamento</li>
              <li><strong>Testing:</strong> Dificulta testes unit√°rios</li>
              <li><strong>Concurrency:</strong> Problemas em ambientes multi-thread</li>
              <li><strong>Memory Leaks:</strong> Inst√¢ncias podem n√£o ser liberadas</li>
            </ul>
          </div>
          <div class="anti-pattern">
            <h5>üîÑ Alternativas</h5>
            <ul>
              <li><strong>Dependency Injection:</strong> Para inje√ß√£o de depend√™ncias</li>
              <li><strong>Factory Pattern:</strong> Para cria√ß√£o de objetos</li>
              <li><strong>Service Locator:</strong> Para localiza√ß√£o de servi√ßos</li>
              <li><strong>Module Pattern:</strong> Para namespacing</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="best-practices">
        <h4>‚úÖ Melhores Pr√°ticas</h4>
        <div class="practices-grid">
          <div class="practice">
            <h5>üéØ Design</h5>
            <ul>
              <li>Use apenas quando realmente necess√°rio</li>
              <li>Implemente thread-safety se necess√°rio</li>
              <li>Considere lazy initialization</li>
              <li>Documente claramente o prop√≥sito</li>
            </ul>
          </div>
          <div class="practice">
            <h5>üß™ Testing</h5>
            <ul>
              <li>Reset singleton entre testes</li>
              <li>Use mocks quando apropriado</li>
              <li>Teste cen√°rios de concorr√™ncia</li>
              <li>Verifique memory leaks</li>
            </ul>
          </div>
          <div class="practice">
            <h5>‚ö° Performance</h5>
            <ul>
              <li>Considere lazy loading</li>
              <li>Monitore uso de mem√≥ria</li>
              <li>Implemente cleanup apropriado</li>
              <li>Use weak references quando poss√≠vel</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="alternatives">
        <h4>üîÑ Alternativas e Padr√µes Relacionados</h4>
        <div class="alternatives-grid">
          <div class="alternative">
            <h5>üíâ Dependency Injection</h5>
            <p>Para inje√ß√£o autom√°tica de depend√™ncias em vez de acesso global.</p>
          </div>
          <div class="alternative">
            <h5>üè≠ Factory Pattern</h5>
            <p>Para cria√ß√£o controlada de objetos em vez de inst√¢ncia √∫nica.</p>
          </div>
          <div class="alternative">
            <h5>üéØ Service Locator</h5>
            <p>Para localiza√ß√£o de servi√ßos sem acoplamento direto.</p>
          </div>
        </div>
      </div>
      
      <div class="code-example">
        <h4>üíª Exemplo de C√≥digo</h4>
        <div class="code-block">
          <pre><code>// Servi√ßo Singleton no Angular
@Injectable({{ '{' }}
  providedIn: 'root' // Garante que seja singleton
{{ '}' }})
export class LoggerService {{ '{' }}
  private static instance: LoggerService | null = null;
  
  private constructor() {{ '{' }}
    // Construtor privado
  {{ '}' }}
  
  public static getInstance(): LoggerService {{ '{' }}
    if (!LoggerService.instance) {{ '{' }}
      LoggerService.instance = new LoggerService();
    {{ '}' }}
    return LoggerService.instance;
  {{ '}' }}
{{ '}' }}

// Uso em componentes
constructor(private logger: LoggerService) {{ '{' }}
  // Mesma inst√¢ncia em toda a aplica√ß√£o
{{ '}' }}</code></pre>
        </div>
      </div>
    </div>
  </div>
</div>
