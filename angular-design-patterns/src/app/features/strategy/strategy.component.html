<div class="strategy-demo demo-container">
  <div class="demo-header">
    <h2>ğŸ¯ Strategy Pattern</h2>
    <p>O Strategy Pattern permite definir uma famÃ­lia de algoritmos, encapsulÃ¡-los e tornÃ¡-los intercambiÃ¡veis.</p>
  </div>

  <div class="demo-content">
    <div class="strategy-selector demo-section">
      <h3>ğŸ¯ Selecionar EstratÃ©gia de Pagamento</h3>
      <div class="form-grid auto-fit">
        <div class="form-group">
          <label>EstratÃ©gia:</label>
          <select [(ngModel)]="selectedStrategy" (change)="setStrategy()" class="form-select">
            <option *ngFor="let strategy of availableStrategies" [value]="strategy.value">
              {{ strategy.icon }} {{ strategy.label }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Valor (R$):</label>
          <input type="number" [(ngModel)]="amount" [min]="0.01" [step]="0.01" class="form-input">
        </div>
      </div>

      <div class="info-card item-list">
        <div class="info-item list-item">
          <span class="info-label">EstratÃ©gia Atual:</span>
          <span class="info-value">{{ getCurrentStrategyInfo() }}</span>
        </div>
      </div>

      <button (click)="processPayment()" class="btn btn-primary">
        ğŸ’³ Processar Pagamento
      </button>
    </div>

    <div class="payment-result demo-section" *ngIf="paymentResult">
      <h3>ğŸ“‹ Resultado do Pagamento</h3>
      <div class="info-card item-list">
        <div class="info-item list-item">
          <span class="info-value">{{ paymentResult }}</span>
        </div>
      </div>
    </div>

    <div class="payment-history demo-section">
      <h3>ğŸ“œ HistÃ³rico de Pagamentos ({{ paymentHistory.length }})</h3>
      <div class="history-controls btn-group">
        <button (click)="clearHistory()" class="btn btn-secondary">ğŸ—‘ï¸ Limpar HistÃ³rico</button>
      </div>
      <div class="history-list item-list">
        <div *ngFor="let payment of paymentHistory; let i = index" class="history-item list-item">
          <span class="history-number">{{ i + 1 }}</span>
          <span class="history-content">{{ payment }}</span>
        </div>
        <div *ngIf="paymentHistory.length === 0" class="empty-state">
          Nenhum pagamento processado ainda
        </div>
      </div>
    </div>
  </div>

  <div class="explanation">
    <h3>ğŸ” Strategy Pattern - Conceito e ImplementaÃ§Ã£o</h3>
    <div class="explanation-content">

      <div class="concept content-card">
        <h4>ğŸ“š Conceito</h4>
        <p>O Strategy Pattern Ã© um padrÃ£o comportamental que define uma famÃ­lia de algoritmos, encapsula cada um deles e os torna intercambiÃ¡veis. O Strategy permite que o algoritmo varie independentemente dos clientes que o utilizam.</p>
        <p><strong>Problema que resolve:</strong> Como permitir que um algoritmo seja selecionado em tempo de execuÃ§Ã£o? Como evitar condicionais complexas para escolher entre diferentes algoritmos?</p>
      </div>

      <div class="flow content-card">
        <h4>ğŸ”„ Fluxo de Funcionamento</h4>
        <div class="flow-steps">
          <div class="flow-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <strong>DefiniÃ§Ã£o da Interface</strong>
              <p>Define uma interface comum para todas as estratÃ©gias (PaymentStrategy).</p>
            </div>
          </div>
          <div class="flow-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <strong>ImplementaÃ§Ã£o das EstratÃ©gias</strong>
              <p>Cada estratÃ©gia concreta implementa a interface (CreditCard, PIX, etc.).</p>
            </div>
          </div>
          <div class="flow-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <strong>Contexto</strong>
              <p>O contexto (PaymentContext) mantÃ©m uma referÃªncia para a estratÃ©gia atual.</p>
            </div>
          </div>
          <div class="flow-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <strong>ExecuÃ§Ã£o</strong>
              <p>O contexto delega a execuÃ§Ã£o para a estratÃ©gia selecionada.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="angular-specific content-card">
        <h4>ğŸ…°ï¸ Como Funciona no Angular</h4>
        <p>No Angular, o Strategy Pattern Ã© usado em vÃ¡rias situaÃ§Ãµes:</p>
        <ul>
          <li><strong>Form Validators:</strong> Diferentes estratÃ©gias de validaÃ§Ã£o para formulÃ¡rios</li>
          <li><strong>HTTP Interceptors:</strong> Diferentes estratÃ©gias de interceptaÃ§Ã£o de requisiÃ§Ãµes</li>
          <li><strong>Route Guards:</strong> Diferentes estratÃ©gias de proteÃ§Ã£o de rotas</li>
          <li><strong>Data Transformers:</strong> Diferentes estratÃ©gias de transformaÃ§Ã£o de dados</li>
        </ul>
      </div>

      <div class="code-example content-card">
        <h4>ğŸ’» CÃ³digo do Exemplo</h4>
        <div class="code-block">
          <div class="code-header">
            <div class="traffic-lights">
              <div class="traffic-light close"></div>
              <div class="traffic-light minimize"></div>
              <div class="traffic-light maximize"></div>
            </div>
            <div class="code-title">payment-strategy.interface.ts</div>
          </div>
          <pre><code>// Interface Strategy
export interface PaymentStrategy &#123;
  processPayment(amount: number): string;
  getStrategyName(): string;
  getDescription(): string;
&#125;

// EstratÃ©gia Concreta - PIX
export class PixStrategy implements PaymentStrategy &#123;
  constructor(private pixKey: string) &#123;&#125;

  processPayment(amount: number): string &#123;
    return `Pagamento de R$ $&#123;amount&#125; processado via PIX`;
  &#125;

  getStrategyName(): string &#123;
    return 'PIX';
  &#125;

  getDescription(): string &#123;
    return 'Pagamento instantÃ¢neo via PIX';
  &#125;
&#125;

// Contexto
@Injectable(&#123; providedIn: 'root' &#125;)
export class PaymentContextService &#123;
  private currentStrategy: PaymentStrategy | null = null;

  setStrategy(strategy: PaymentStrategy): void &#123;
    this.currentStrategy = strategy;
  &#125;

  processPayment(amount: number): string &#123;
    if (!this.currentStrategy) &#123;
      throw new Error('Nenhuma estratÃ©gia definida');
    &#125;
    return this.currentStrategy.processPayment(amount);
  &#125;
&#125;</code></pre>
        </div>
      </div>

    </div>
  </div>
</div>
